<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <META content="no-cache" http-equiv="pragma">
    <META content="-1" http-equiv="expires">
    <META content="text/html;charset=UTF-8" http-equiv="content-type">
    <LINK href="problem-statement.css" rel="stylesheet" type="text/css">
    <TITLE>Шахматные доски</TITLE>
</HEAD><BODY>
    <DIV class="problem-statement"><DIV class="header"><DIV class="title">Шахматные доски</DIV><DIV class="time-limit"><DIV class="property-title">ограничение по времени на тест</DIV>10 секунд</DIV><DIV class="memory-limit"><DIV class="property-title">ограничение по памяти на тест</DIV>64 мегабайта</DIV><DIV class="input-file"><DIV class="property-title">ввод</DIV>стандартный ввод</DIV><DIV class="output-file"><DIV class="property-title">вывод</DIV>стандартный вывод</DIV></DIV><DIV class="legend"><P>Как известно, шахматные доски делают из коры крайне редкого хорватского шахматного дерева (Biggus Mobydiccus). Кору этого дерева сняли и развернули в огромный прямоугольный лист из черных и белых квадратов. Из этого листа на фабрике сделают несколько шахматных досок разного размера. Шахматной доской называется квадратный кусок коры со сторонами, параллельными сторонам прямоугольника, у которого никакие две соседние по стороне клетки не имеют одинаковый цвет.</P><P>Доски вырезают с помощью жадного алгоритма: каждый раз вырезаю максимальную по размеру шахматную доску, если есть несколько таких, выбирают самую верхний, а среди таких &mdash; самую левую. Доски вырезают, пока весь лист не кончится. Возможно, даже дойдет до того, что будут вырезаны нано-доски <SPAN class="tex-span">1&thinsp;&times;&thinsp;1</SPAN>.</P><P>Вот пример, показывающий лист коры доска и первые семь шахматных досок, которые будут из него вырезаны.</P><P></P><CENTER> <IMG class="tex-graphics" height="378px" src="8188ee144c45347c93c12e10649f03eb1ae0738a.png" width="378px"> </CENTER><P></P><P>Вам дано описание листа коры шахматного дерева. Посчитайте, сколько и каких досок получится из него в конце процесса.</P></DIV><P></P><P></P><DIV class="input-specification"><DIV class="section-title">Входные данные</DIV><P></P><P>Первая строка ввода содержит количество тестов <SPAN class="tex-span"><I>t</I></SPAN>. Далее следуют описания <SPAN class="tex-span"><I>t</I></SPAN> тестов. Каждый тест начинается со строки, содержащей размеры коры сетки, <SPAN class="tex-span"><I>m</I></SPAN> и <SPAN class="tex-span"><I>n</I></SPAN>, при этом <SPAN class="tex-span"><I>n</I></SPAN> всегда кратна 4. Следующие <SPAN class="tex-span"><I>m</I></SPAN> строк содержат строки по <SPAN class="tex-span"><I>n</I>&thinsp;/&thinsp;4</SPAN> символов &mdash; представления строк коры в шестнадцатеричном виде. Двоичное представление этих чисел даст вам строки из <SPAN class="tex-span"><I>n</I></SPAN> бит, по одному для каждой строки. Нули обозначают черные квадраты, а единицы &mdash; белые квадраты. Строки заданы сверху вниз. В каждой строке, наиболее значимый бит шестнадцатеричного числа соответствует крайней слева ячейке этой строки.</P><P>Ограничения: <SPAN class="tex-span">1&thinsp;&le;&thinsp;<I>t</I>&thinsp;&le;&thinsp;100</SPAN>, <SPAN class="tex-span"><I>n</I></SPAN> делится на 4.</P><P>В задаче 1: <SPAN class="tex-span">1&thinsp;&le;&thinsp;<I>n</I>,&thinsp;<I>m</I>&thinsp;&le;&thinsp;32</SPAN>.</P><P>В задаче 2: <SPAN class="tex-span">1&thinsp;&le;&thinsp;<I>n</I>,&thinsp;<I>m</I>&thinsp;&le;&thinsp;512</SPAN>.</P></DIV><P></P><P></P><DIV class="output-specification"><DIV class="section-title">Выходные данные</DIV><P></P><P>Для каждого теста выведите строку, содержащую число <SPAN class="tex-span"><I>k</I></SPAN> &mdash; число различных размеров шахматной досок, которые будут вырезаны, следуя процедуре, описанной выше. Следующие <SPAN class="tex-span"><I>k</I></SPAN> строк должны содержать по два целых числа &mdash; размер шахматной доски (от большего к меньшему) и количество шахматных досок такого размера, которые будут вырезаны.</P></DIV><P></P><P></P><DIV class="sample-tests"><DIV class="section-title">Примеры тестов</DIV><P></P><P></P><DIV class="sample-test"><DIV class="input"><DIV class="title">Входные данные</DIV><PRE class="content">4<BR>15 20<BR>55555<BR>FFAAA<BR>2AAD5<BR>D552A<BR>2AAD5<BR>D542A<BR>4AD4D<BR>B52B2<BR>52AAD<BR>AD552<BR>AA52D<BR>AAAAA<BR>5AA55<BR>A55AA<BR>5AA55<BR>4 4<BR>0<BR>0<BR>0<BR>0<BR>4 4<BR>3<BR>3<BR>C<BR>C<BR>4 4<BR>6<BR>9<BR>9<BR>6<BR></PRE></DIV><DIV class="output"><DIV class="title">Выходные данные</DIV><PRE class="content">5<BR>6 2<BR>4 3<BR>3 7<BR>2 15<BR>1 57<BR>1<BR>1 16<BR>2<BR>2 1<BR>1 12<BR>1<BR>2 4<BR></PRE></DIV></DIV></DIV></DIV>   

</BODY></HTML>