структуры данных
дерево отрезков
дерево отрезков сортированных массивов
корневая оптимизация
