Разобьем квадрат на sqrtN x sqrtN маленьких квадратиков.
Прямая полуплоскости пересекает не более 2sqrtN квадратиков,
остальные целиком снаружи/внутри и их можно учесть с помощью частичных сумм.

В пересеченных же 2sqrtN квадратах матожидание числа точек = 2sqrtN, т.е. время ответа на запрос = 2sqrtN.
